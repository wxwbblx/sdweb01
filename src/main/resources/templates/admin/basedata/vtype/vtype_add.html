<!doctype html>
<html lang="en">
<meta charset="UTF-8">
  <meta name="Generator" content="EditPlus®">
  <meta name="Author" content="">
  <meta name="Keywords" content="">
  <meta name="Description" content="">
  <link rel="stylesheet" type="text/css" href="../../bs3/css/style.css" />
<link rel="stylesheet" type="text/css" href="../../bs3/css/WdatePicker.css" />
<link rel="stylesheet" type="text/css" href="../../bs3/css/skin_/form.css" />
<link href="umeditor/themes/default/_css/umeditor.css" type="text/css" rel="stylesheet">

<link rel="stylesheet" type="text/css" href="../../bs3/css/jquery.grid.css" />
<link rel="stylesheet" type="text/css" href="../../bs/css/bootstrap.min.css">

<script type="text/javascript" src="../../bs3/js/jquery.js"></script>
<script type="text/javascript" src="../../bs3/js/global.js"></script>
<script type="text/javascript" src="../../bs3/js/jquery.select.js"></script>
<script type="text/javascript" src="../../bs3/js/WdatePicker.js"></script>
<script type="text/javascript">
window.UMEDITOR_HOME_URL = 'umeditor/';  // 请换成绝对路径
</script>
<script type="text/javascript" src="../../bs3/js/umeditor.config.js"></script>
<script type="text/javascript" src="../../bs3/js/editor_api.js"></script>
<script type="text/javascript" src="../../bs3/umeditor/lang/zh-cn/zh-cn.js"></script>
<title th:text="${title}">a</title>
</head>

<body>
<div id="container">
	<div id="hd">
    </div>
    <div id="bd">
	    <form class="form-signin" role="form" action="/admin/vtype/vtype_add" enctype="multipart/form-data" method="post">
	    	<div id="main">
	            <h2 class="subfild">
	            	<span>视频类型编辑</span>
	            </h2>            
	            <div class="subfild-content base-info">
	            	<div class="kv-item ue-clear">
	                	<label><span class="impInfo">*</span>视频类型</label>
	                	<div class="kv-item-content">
	                    	<input type="text" placeholder="视频类型" name="vtype" maxlength="30" />
	                    </div>
	                    <span class="kv-item-tip">视频类型字数限制在30个字符</span>
	                </div>	                
	            </div>
	            <h2 class="subfild">
	            	<span>备注资料</span>
	            </h2>
	            
	            <div class="subfild-content remarkes-info">
	            	<div class="kv-item ue-clear">
	                	<label><span class="impInfo">*</span>备注资料</label>
	                	<div class="kv-item-content">
	                    	<textarea placeholder="备注资料" id="remark" name="remark" style="width:400px;height:100px;" ></textarea>
	                    </div>
	                </div>
	            </div>
	           
	            <h2 class="subfild">
	            	<span></span>
	            </h2>
	            
	            <div class="buttons">
	                <input class="button" type="submit" value="提交" onclick="/admin/prog_add" /> 
	                <a class="button btn btn-primary" href="/admin/vtype/loadvtype;" >返回</a>
	            </div>
	            
	        </div>
         </form>
    </div>
    
</div>

    
</body>
<script>
  var eleFile = document.querySelector('.file');
  var image = document.querySelector("img")
  var button = document.querySelector("button")
  // 压缩图片需要的一些元素和对象
  var targetWidth, targetHeight
  var reader = new FileReader(),
  img = new Image();
 
  // 选择的文件对象
  var file = null;
 
  // base64地址图片加载完毕后
  img.onload = function () {
    // 图片原始尺寸
    var originWidth = this.width;
    var originHeight = this.height;
    // 最大尺寸限制
    var maxWidth = 600,
      maxHeight = 500;
    // 目标尺寸
    targetWidth = originWidth,
      targetHeight = originHeight;
    // 图片尺寸超过400x400的限制
    if (originWidth > maxWidth || originHeight > maxHeight) {
      if (originWidth / originHeight > maxWidth / maxHeight) {
        // 更宽，按照宽度限定尺寸
        targetWidth = maxWidth;
        targetHeight = Math.round(targetWidth* (originHeight / originWidth));
      } else {
        targetHeight = maxHeight;
        targetWidth = Math.round(targetHeight* (originWidth / originHeight));
      }
    }
    image.width = targetWidth
    image.height = targetHeight
  };
 
  // 文件base64化，以便获知图片原始尺寸
  reader.onload = function (e) {
    img.src = e.target.result;
    image.src = e.target.result
  };
  eleFile.addEventListener('change', function (event) {
    file = event.target.files[0];
    // 选择的文件是图片
    if (file.type.indexOf("image") == 0) {
      reader.readAsDataURL(file);
    }
  });
  button.addEventListener('click', function () {
    if (!file) {
      return
    }
    var formData = new FormData()
    formData.append(file.name, file)
    uploadImage(formData)
  })
 
  function uploadImage(formdata) {
    // ....调用ajax上传图片
  }
</script>
</html>
